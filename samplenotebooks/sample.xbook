[{"kind":1,"language":"markdown","value":"# XPath 3.1 Notebook Sample\n\nFeatures:\n - XPath Formatting / Syntax Highlighting / Problem Reporting\n - JSON output for representing maps, arrays and sequences\n - Use of `Go to Defintion` command for XML nodes in the output\n - Evaluation context XML Namespaces set from target document\n - Built-in namespaces for XPath namespaces like `array` and `map`"},{"kind":2,"language":"xpath","value":"[\"one\", \"two\", \"three\", \"four\"]"},{"kind":2,"language":"xpath","value":"[[\"one\",1], [\"two\",2], [\"three\",3], [\"four\",4]]"},{"kind":2,"language":"xpath","value":"map {'abc': 'alpha', 'def': 'bravo','hih': 'charlie'}"},{"kind":2,"language":"xpath","value":"map {'abc': ['alpha',1], 'def': ['bravo',2],'hih': ['charlie',3]}"},{"kind":2,"language":"xpath","value":"[\n    map {'abc': 'alpha', 'def': 'bravo','hih': 'charlie'},\n    map {'abc': 'alpha2', 'def': 'bravo','hih2': 'charlie2'},\n    map {'abc': 'alpha3', 'de': 'bravo3','hih': 'charlie3'},\n    map {'abc': 'alpha4', 'de': 'bravo4','hih': 'charlie4'}\n]"},{"kind":2,"language":"xpath","value":"let $authorArray := array {(\n            /authors/author!\n            map:merge((\n                    map:entry('last', string(@last)),\n                    map:entry('attrFirst', @first)\n                )))\n    } return\n    map { \"author\": $authorArray }"},{"kind":1,"language":"markdown","value":"## XPath Variable References\nUse `$_` variable to reference the result of the last cell executed:"},{"kind":2,"language":"xpath","value":"$_?book?author[2]"},{"kind":2,"language":"javascript","value":"var anyDoc = {xml: \"http://www.w3.org/XML/1998/namespace\",_d: \"color.com\",abc: \"abc.com\"};\r\nvar target2 = {};\r\nvar entries = Object.entries(anyDoc);\r\nconsole.log(entries);\r\nvar uris = Object.entries(anyDoc).forEach((kvp) => {\r\n  const [name, value] = kvp;\r\n  target2[value] = name;\r\n});\r\nconsole.log(target2);"},{"kind":2,"language":"javascript","value":"var anyDoc = {xml: \"http://www.w3.org/XML/1998/namespace\",_d: \"color.com\",abc: \"abc.com\"};\nvar invXmlns = {};\nObject.entries(anyDoc).forEach((kvp) => {\n  const [name, value] = kvp;\n  invXmlns[value] = name;\n});\nconsole.log(target2);"},{"kind":2,"language":"javascript","value":"var newx = {\n  'http://www.w3.org/XML/1998/namespace': 'xml',\n  'color.com': '_d',\n  'abc.com': 'abc'\n};\nvar result2 = 'Q{abc.com}body/Q{abc.com}div/@Q{http://www.w3.org/XML/1998/namespace}para'.replace(/Q{[^{]*}/g, (match) => {\n  const uri = match.substring(2, match.length - 1);\n  const pfx = newx[uri];\n  if (pfx) {\n    return pfx === '_d'? '' : pfx + ':';\n  } else {\n    return match;\n  }\n  });\nresult2\n"},{"kind":2,"language":"xpath","value":"string-to-codepoints('_d')"},{"kind":2,"language":"xpath","value":"codepoints-to-string([95,100])"},{"kind":2,"language":"javascript","value":"let options = {\r\n    namespaceContext: {\r\n        'xsi': 'http://www.w3.org/2001/XMLSchema-instance',\r\n        'array': 'http://www.w3.org/2005/xpath-functions/array',\r\n        'map': 'http://www.w3.org/2005/xpath-functions/map',\r\n        'math': 'http://www.w3.org/2005/xpath-functions/math'\r\n    }\r\n}"},{"kind":2,"language":"xpath","value":"for $a in 1 to 20 return $a"},{"kind":2,"language":"xpath","value":"map {'key': 25, 'abc': 28, 'new': 29, 'more': 87}"},{"kind":2,"language":"xpath","value":"map {'key': 25, 'abc': 28, 'new': 29}"},{"kind":2,"language":"xpath","value":"(/*/*)[position() < 4]"},{"kind":2,"language":"xpath","value":"(/*/*/@*)[position() < 4]"},{"kind":2,"language":"javascript","value":"console.log('start of third cell');\nprint(`a: ${a}`);\nprint(`b: ${b}`);\nprint(`c: ${c}`);\nconsole.log('end of third cell');"},{"kind":1,"language":"markdown","value":"## XPath Evaluation Context\n### XML Namespaces\n### $_ variable for previous cell result"},{"kind":2,"language":"xpath","value":"map { 'first': (/authors/author/@first)[1]}"},{"kind":2,"language":"xpath","value":"/authors/author/@first"}]